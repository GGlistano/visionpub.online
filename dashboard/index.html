<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Gerador de Checkouts v2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="config.js?v=2.0"></script>
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .loading { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .step-content { display: none; }
        .step-content.active { display: block; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- VERS√ÉO 2.0 - SISTEMA COMPLETO -->
    <div id="version-info" class="hidden">v2.0</div>
    
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-gray-900">üéõÔ∏è Dashboard v2.0</h1>
                    <span class="ml-3 text-sm text-gray-500">Gerador de Checkouts</span>
                </div>
                <div class="flex items-center space-x-4">
                    <span id="user-info" class="text-sm text-gray-600"></span>
                    <button id="logout-btn" class="text-red-600 hover:text-red-800 text-sm">Sair</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Login Screen -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center">
        <div class="max-w-md w-full space-y-8 p-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-gray-900">üîê Login Admin</h2>
                <p class="mt-2 text-gray-600">Dashboard v2.0 - Sistema Completo</p>
            </div>
            <form id="login-form" class="space-y-6">
                <div>
                    <input id="email" type="email" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="Email">
                </div>
                <div>
                    <input id="password" type="password" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                           placeholder="Senha">
                </div>
                <button type="submit" 
                        class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Entrar
                </button>
            </form>
            <div id="login-error" class="text-red-600 text-sm text-center hidden"></div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="hidden">
        <!-- Stats Cards -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white p-6 rounded-lg shadow-sm border">
                    <div class="flex items-center">
                        <div class="p-2 bg-blue-100 rounded-lg">
                            <span class="text-2xl">üõí</span>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Produtos</p>
                            <p id="total-products" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border">
                    <div class="flex items-center">
                        <div class="p-2 bg-green-100 rounded-lg">
                            <span class="text-2xl">üí∞</span>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Vendas (M√™s)</p>
                            <p id="total-sales" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border">
                    <div class="flex items-center">
                        <div class="p-2 bg-yellow-100 rounded-lg">
                            <span class="text-2xl">üìä</span>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Faturamento</p>
                            <p id="total-revenue" class="text-2xl font-bold text-gray-900">0 MZN</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-sm border">
                    <div class="flex items-center">
                        <div class="p-2 bg-purple-100 rounded-lg">
                            <span class="text-2xl">üéØ</span>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm text-gray-600">Convers√£o</p>
                            <p id="conversion-rate" class="text-2xl font-bold text-gray-900">0%</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Section -->
            <div class="bg-white rounded-lg shadow-sm border">
                <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                    <h2 class="text-lg font-semibold text-gray-900">üõí Produtos</h2>
                    <button id="new-product-btn" 
                            class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        ‚ûï Novo Produto
                    </button>
                </div>
                <div id="products-list" class="divide-y divide-gray-200">
                    <div class="p-6 text-center text-gray-500">
                        <span class="text-4xl mb-4 block">üì¶</span>
                        <p>Nenhum produto criado ainda</p>
                        <p class="text-sm">Clique em "Novo Produto" para come√ßar</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Wizard Multi-Etapas -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <!-- Header com Progress Bar -->
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="modal-title" class="text-lg font-semibold text-gray-900">‚ûï Criar Novo Produto</h3>
                    <button id="close-modal" class="text-gray-400 hover:text-gray-600">
                        <span class="text-2xl">&times;</span>
                    </button>
                </div>
                
                <!-- Progress Bar -->
                <div class="flex items-center space-x-4">
                    <div class="flex-1">
                        <div class="flex items-center">
                            <div id="step-1-circle" class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-sm font-medium">1</div>
                            <div class="flex-1 h-1 bg-gray-200 mx-2">
                                <div id="progress-1-2" class="h-1 bg-gray-200 transition-all duration-300"></div>
                            </div>
                            <div id="step-2-circle" class="w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center text-sm font-medium">2</div>
                            <div class="flex-1 h-1 bg-gray-200 mx-2">
                                <div id="progress-2-3" class="h-1 bg-gray-200 transition-all duration-300"></div>
                            </div>
                            <div id="step-3-circle" class="w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center text-sm font-medium">3</div>
                        </div>
                        <div class="flex justify-between mt-2 text-xs text-gray-500">
                            <span>B√°sico</span>
                            <span>T√©cnico</span>
                            <span>Finalizar</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <form id="product-form" class="p-6">
                <!-- ETAPA 1: Informa√ß√µes B√°sicas -->
                <div id="step-1" class="step-content active">
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">üìù Informa√ß√µes B√°sicas</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Produto *</label>
                                    <input id="product-name" type="text" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           placeholder="Ex: LifeBoost Secrets">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Pre√ßo (MZN) *</label>
                                    <input id="product-price" type="number" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           placeholder="197">
                                </div>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Descri√ß√£o (Opcional)</label>
                                <textarea id="product-description" rows="3"
                                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                          placeholder="Descri√ß√£o do produto..."></textarea>
                            </div>
                        </div>

                        <!-- Imagem do Produto -->
                        <div>
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">üì∑ Imagem do Produto</h4>
                            <div class="space-y-4">
                                <!-- Upload de arquivo -->
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors">
                                    <input type="file" id="image-upload" accept="image/*" class="hidden">
                                    <div class="text-4xl mb-2">üìÅ</div>
                                    <button type="button" id="upload-btn" 
                                            class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        üìÅ Escolher Arquivo
                                    </button>
                                    <p class="text-sm text-gray-500 mt-2">Ou cole uma URL abaixo</p>
                                    <div id="upload-progress" class="hidden mt-2">
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full animate-pulse"></div>
                                        </div>
                                        <p class="text-sm text-gray-600 mt-1">Enviando imagem...</p>
                                    </div>
                                </div>
                                
                                <!-- URL manual -->
                                <input id="product-image" type="url" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                       placeholder="URL da imagem (ex: https://exemplo.com/imagem.jpg)">
                                
                                <!-- Preview -->
                                <div id="image-preview" class="mt-4 hidden text-center">
                                    <img id="preview-img" class="mx-auto h-32 w-32 object-cover rounded-lg border shadow-sm">
                                    <p class="text-sm text-green-600 mt-2">‚úÖ Imagem carregada</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ETAPA 2: Configura√ß√µes T√©cnicas -->
                <div id="step-2" class="step-content">
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">‚öôÔ∏è Configura√ß√µes T√©cnicas</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Prefixo OrderID *</label>
                                    <input id="order-prefix" type="text" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           placeholder="VP-" maxlength="10">
                                    <p class="text-xs text-gray-500 mt-1">Ex: VP-, UP1-, P3-</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">URL do Checkout *</label>
                                    <input id="checkout-url" type="text" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           placeholder="lifeboost">
                                    <p class="text-xs text-gray-500 mt-1">visionpub.online/checkout/<strong>lifeboost</strong></p>
                                </div>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Conta Utmify</label>
                                <select id="utmify-account" 
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="conta1">Conta 1 - Padr√£o</option>
                                    <option value="conta2">Conta 2 - Secund√°ria</option>
                                </select>
                            </div>
                        </div>

                        <!-- Timer da Oferta -->
                        <div>
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">‚è∞ Timer da Oferta</h4>
                            <div class="flex items-center space-x-4 mb-4">
                                <label class="flex items-center">
                                    <input id="timer-enabled" type="checkbox" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                    <span class="ml-2 text-sm text-gray-700">Ativar timer de urg√™ncia</span>
                                </label>
                            </div>
                            <div id="timer-config" class="hidden space-y-4 bg-gray-50 p-4 rounded-lg">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Tempo (minutos)</label>
                                        <input id="timer-minutes" type="number" value="10" min="1" max="60"
                                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Texto do Timer</label>
                                    <input id="timer-text" type="text" value="‚ö† Esta oferta expira em"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ETAPA 3: Finaliza√ß√£o -->
                <div id="step-3" class="step-content">
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">üîó Configura√ß√µes Finais</h4>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">URL de Redirecionamento (Opcional)</label>
                                <input id="redirect-url" type="url"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                       placeholder="https://visionpub.online/upsell">
                                <p class="text-xs text-gray-500 mt-1">Para onde redirecionar ap√≥s a compra</p>
                            </div>
                        </div>

                        <!-- Resumo do Produto -->
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h5 class="font-semibold text-gray-900 mb-3">üìã Resumo do Produto</h5>
                            <div id="product-summary" class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Nome:</span>
                                    <span id="summary-name" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Pre√ßo:</span>
                                    <span id="summary-price" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">OrderID:</span>
                                    <span id="summary-prefix" class="font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Checkout URL:</span>
                                    <span id="summary-url" class="font-medium text-blue-600">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Timer:</span>
                                    <span id="summary-timer" class="font-medium">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot√µes de Navega√ß√£o -->
                <div class="flex justify-between pt-6 border-t border-gray-200 mt-6">
                    <div>
                        <button type="button" id="prev-btn" class="hidden px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            ‚Üê Anterior
                        </button>
                    </div>
                    <div class="flex space-x-4">
                        <button type="button" id="cancel-btn"
                                class="px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            Cancelar
                        </button>
                        <button type="button" id="next-btn"
                                class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            Pr√≥ximo ‚Üí
                        </button>
                        <button type="submit" id="save-btn" class="hidden px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                            üíæ Salvar e Gerar Checkout
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 text-center">
            <div class="loading w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"></div>
            <p class="text-gray-700">Gerando checkout...</p>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
            <div class="p-6 text-center">
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Checkout Criado!</h3>
                <p class="text-gray-600 mb-4">Seu checkout foi gerado com sucesso!</p>
                <div id="checkout-url-display" class="bg-gray-100 p-3 rounded-md mb-4 text-sm font-mono break-all"></div>
                <div class="flex space-x-4">
                    <button id="copy-url-btn" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700">
                        üìã Copiar URL
                    </button>
                    <button id="open-checkout-btn" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700">
                        üîó Abrir
                    </button>
                </div>
                <button id="close-success-modal" class="mt-4 text-gray-500 hover:text-gray-700">Fechar</button>
            </div>
        </div>
    </div>

    <!-- CARREGAMENTO DO APP.JS v2.0 -->
    <script src="app.js?v=2.0&t=<?php echo time(); ?>"></script>
    
    <!-- DEBUG INFO -->
    <script>
        console.log('üöÄ Dashboard v2.0 carregado!');
        console.log('üìÖ Timestamp:', new Date().toISOString());
        console.log('üîß For√ßando reload de cache...');
    </script>
</body>
</html>
