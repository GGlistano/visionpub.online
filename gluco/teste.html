<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Apresentação Especial</title>
  <style>
    :root {
      --red: #d9250d;
      --dark: #222;
      --text: #fff;
      --maxw: 1200px;
      --bar-h: 56px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
      background: #fff;
      color: #0b0b0b;
      line-height: 1.45;
    }
    /* Top bar */
    .topbar {
      position: fixed;
      inset: 0 0 auto 0;
      height: var(--bar-h);
      background: var(--red);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 16px;
      text-align: center;
      z-index: 9999;
      font-weight: 600;
    }
    .topbar span.city {
      font-weight: 800;
      padding: 0 4px;
    }
    /* Main */
    main {
      max-width: var(--maxw);
      margin: 0 auto;
      padding: calc(var(--bar-h) + 24px) 16px 32px; /* empurra para baixo por causa da barra fixa */
    }
    /* Vturb player wrapper para centralizar */
    .player-wrap {
      width: 100%;
      margin: 0 auto;
      display: block;
    }
    /* Viewers line */
    .viewers {
      margin: 14px 0 28px;
      text-align: center;
      font-size: 16px;
      color: #222;
      opacity: .85;
    }
    /* Footer */
    footer {
      background: var(--dark);
      color: var(--text);
      padding: 28px 16px 40px;
    }
    .foot-inner {
      max-width: var(--maxw);
      margin: 0 auto;
      text-align: center;
      opacity: .95;
    }
    .foot-inner a {
      color: #e6e6e6;
      text-decoration: none;
    }
    .foot-inner a:hover { text-decoration: underline; }
    .muted { opacity: .85; }
  </style>
</head>
<body>
  <!-- Barra fixa vermelha -->
  <div class="topbar" id="topbar">
    Usted y algunas personas de <span class="city">>>&nbsp;Maputo&nbsp;<<</span> han sido seleccionados para ver esta presentación.
  </div>

  <main>
    <!-- Seu vídeo Vturb -->
    <div class="player-wrap">
      <vturb-smartplayer id="vid-6910f4953cf93344c37ca45c" style="display:block;margin:0 auto;width:100%;"></vturb-smartplayer>
    </div>

    <div class="viewers">
      <span id="viewerCount">563</span> pessoas estão assistindo agora...
    </div>
  </main>

  <!-- Rodapé preto -->
  <footer>
    <div class="foot-inner">
      <div class="muted">Copyright 2025 - Gluco Zero App ®</div>
      <div class="muted">Todos os Direitos Reservados</div>
      <div style="margin-top:8px;">
        <a href="#">Condiciones de uso</a> · <a href="#">Privacidad</a>
      </div>
      <div style="margin-top:10px;">Insira um disclaimer aqui...</div>
    </div>
  </footer>

  <!-- Script do player Vturb -->
  <script>
    (function(){
      var s = document.createElement("script");
      s.src = "https://scripts.converteai.net/9d93e4b2-3654-4bea-bda0-107c1328d520/players/6910f4953cf93344c37ca45c/v4/player.js";
      s.async = true;
      document.head.appendChild(s);
    })();
  </script>

  <!-- Geolocalização + contador dinâmico -->
  <script>
    // -------- Cidade por IP (fallback elegante) --------
    async function setCityText(city) {
      const span = document.querySelector('.topbar .city');
      if (!span) return;
      span.textContent = ">>" + (city || "sua área") + "<<";
    }

    // Tenta ipapi.co (sem chave). Fallback para navigator.geolocation + Nominatim.
    (async function resolveCity(){
      try {
        const ctrl = new AbortController();
        const t = setTimeout(() => ctrl.abort(), 4000);
        const r = await fetch("https://ipapi.co/json/", {signal: ctrl.signal});
        clearTimeout(t);
        if (r.ok) {
          const j = await r.json();
          const city = j.city || j.region || j.country_name;
          await setCityText(city);
          return;
        }
      } catch(e) { /* segue pro fallback */ }

      // Fallback com geolocalização do browser (pede permissão)
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async (pos) => {
          try {
            const { latitude, longitude } = pos.coords;
            const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`;
            const r = await fetch(url, { headers: { "Accept-Language": "es,en,pt" }});
            const j = await r.json();
            const city = j.address?.city || j.address?.town || j.address?.village || j.address?.state;
            await setCityText(city);
          } catch { setCityText(null); }
        }, () => setCityText(null), { enableHighAccuracy:false, timeout:4000, maximumAge:600000 });
      } else {
        setCityText(null);
      }
    })();

    // -------- Contador “ao vivo” (500–999) --------
    (function viewersTicker(){
      const el = document.getElementById('viewerCount');
      // valor inicial aleatório
      let count = Math.floor(500 + Math.random() * 500); // 500..999
      function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }
      function render(){ el.textContent = count.toString(); }
      render();

      // Variações naturais a cada 8–18s
      function tick(){
        const delta = Math.floor((Math.random() * 13) - 5); // -5..+7
        count = clamp(count + delta, 500, 999);
        render();
        const next = 8000 + Math.random() * 10000; // 8s..18s
        setTimeout(tick, next);
      }
      setTimeout(tick, 6000 + Math.random() * 6000); // 6–12s para primeira troca
    })();
  </script>
</body>
</html>
